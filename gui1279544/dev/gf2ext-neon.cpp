
#include "gf2ext-neon.hpp"
//#include <stdint.h>

#ifdef _DEBUG_
static uint8_t log_tab0[16] = {0xc0,0x0,0x1,0x4, 0x2,0x8,0x5,0xa, 0x3,0xe,0x9,0x7, 0x6,0xd,0xb,0xc};
const uint8_t * _gf16_l0 = log_tab0;
#endif

static uint8_t log_tab[16] = {0xc0,3,0x0,14,0x1,9,0x4,7, 0x2,6,0x8,13,0x5,11,0xa,12 };
const uint8_t * _gf16_log_tbl = log_tab;

#ifdef _DEBUG_
static uint8_t exp_tab0[32] = {0x1,0x2,0x4,0x8, 0x3,0x6,0xc,0xb, 0x5,0xa,0x7,0xe, 0xf,0xd,0x9,0x1
		,0x2,0x4,0x8,0x3 ,0x6,0xc,0xb,0x5 ,0xa,0x7,0xe,0xf ,0xd,0x9,0x1,0x2};
const uint8_t * _gf16_e0 = exp_tab0;
#endif

//static uint8_t exp_tab2[16] = {0x1,5,0x2,10,0x4,7,0x8,14, 0x3,15,0x6,13,0xc,9,0xb,1};
//const uint8_t * _gf16_exp_tbl2 = exp_tab2;

static uint32_t exp_tab[8] = { 0x0a020501, 0x07040a02, 0x0e080704, 0x0f030e08, 0x0d060f03, 0x090c0d06, 0x010b090c, 0x0205010b};
const uint8_t * _gf16_exp_tbl = (const uint8_t *)exp_tab;

static uint8_t msk_12_byte[16] = {0xff,0xff,0xff,0xff, 0xff,0xff,0xff,0xff, 0xff,0xff,0xff,0xff, 0,0,0,0};
const uint8_t * _msk_12_byte = msk_12_byte;

// __m128i mul_tbl_0x2 = _mm_set_epi8(0xd,0xf,9,0xb, 5,7,1,3, 0xe,0xc,0xa,8, 6,4,2,0);
static uint8_t mul_tbl_0x2[16] = {0,3,2,1,4,7,6,5, 8,0xb,0xa,9,0xc,0xf,0xe,0xd};
const uint8_t * _gf16_mul_0x2 = mul_tbl_0x2;

//const __m128i gf2ext_sse_tbl<W>::mul_tbl_0x8 = _mm_set_epi8( 1,9,2,0xa, 7,0xf,4,0xc, 0xd,5,0xe,6, 0xb,3,8,0);
static uint8_t mul_tbl_0x8[16] = {0,0xc,8,4,3,0xf,0xb,7, 6,0xa,0xe,2,5,9,0xd,1};
const uint8_t * _gf16_mul_0x8 = mul_tbl_0x8;





template <>
const uint8_t gf2ext_neon<96>::_mask[16] = {0xff,0xff,0xff,0xff, 0xff,0xff,0xff,0xff, 0xff,0xff,0xff,0xff, 0,0,0,0};

template <>
const uint8_t gf2ext_neon<128>::_mask[16] = {0xff,0xff,0xff,0xff, 0xff,0xff,0xff,0xff, 0xff,0xff,0xff,0xff, 0xff,0xff,0xff,0xff};


#include "gf2ext-iso.h"

template <>
const uint8_t * gf2ext_neon<96>::isomorphism = (const uint8_t *)isomorphism_96;

template <>
const uint8_t * gf2ext_neon<96>::isomorphism_1 = (const uint8_t *)ivs_isomorphism_96;


template <>
const uint8_t * gf2ext_neon<128>::isomorphism = (const uint8_t *)isomorphism_128;

template <>
const uint8_t * gf2ext_neon<128>::isomorphism_1 = (const uint8_t *)ivs_isomorphism_128;

